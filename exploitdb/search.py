import requests, json, os
import cve_searchsploit as CS

from pprint import pprint

sign = input('Enter Signature : ')
sign = re.sub('^/+', '', sign)
url = "https://api.github.com/search/code"
payload = {"q":sign+" repo:offensive-security/exploitdb"}
res_json = requests.get(url, params=payload)
res = json.loads(res_json.text)

if res["total_count"]!=0:
  arr = {}
  for item in res["items"]:
    edbid = os.path.splitext(item['name'])[0]
    cve = CS.cve_from_edbid(edbid)[0]
    if cve is None:
      cve = "EDB-"+edbid
    arr[edbid] = {'cve': cve, 'url':'https://www.exploit-db.com/exploits/'+edbid}
  print(arr)
else:
  print("Not Found")

  
  
